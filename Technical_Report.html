<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ali Ahmed, Andreina Arias, Kaylie Evans, Naomi Buell, and Zaneta Paulusova">
<meta name="dcterms.date" content="2025-04-23">

<title>DATA 624 Project 2: Technical Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Technical_Report_files/libs/clipboard/clipboard.min.js"></script>
<script src="Technical_Report_files/libs/quarto-html/quarto.js"></script>
<script src="Technical_Report_files/libs/quarto-html/popper.min.js"></script>
<script src="Technical_Report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Technical_Report_files/libs/quarto-html/anchor.min.js"></script>
<link href="Technical_Report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Technical_Report_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Technical_Report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Technical_Report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Technical_Report_files/libs/bootstrap/bootstrap-973236bd072d72a04ee9cd82dcc9cb29.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DATA 624 Project 2: Technical Report</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ali Ahmed, Andreina Arias, Kaylie Evans, Naomi Buell, and Zaneta Paulusova </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 23, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="instructions" class="level2">
<h2 class="anchored" data-anchor-id="instructions">Instructions</h2>
<p><em>This is role playing. I am your new boss. I am in charge of production at ABC Beverage and you are a team of data scientists reporting to me. My leadership has told me that new regulations are requiring us to understand our manufacturing process, the predictive factors and be able to report to them our predictive model of PH.</em></p>
<p><em>Please use the historical data set I am providing. Build and report the factors in BOTH a technical and non-technical report. I like to use Word and Excel. Please provide your non-technical report in a business friendly readable document and your predictions in an Excel readable format. The technical report should show clearly the models you tested and how you selected your final approach.</em></p>
<p><em>Please submit both Rpubs links and .rmd files or other readable formats for technical and non-technical reports. Also submit the excel file showing the prediction of your models for pH.</em></p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this technical report, we will analyze the manufacturing process of ABC Beverage to understand the factors that influence the pH level of the product. We will build predictive models to forecast pH levels based on various predictors in the dataset. The goal is to provide insights into the manufacturing process and to create a model that can be used for future predictions.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>We will use the following packages for data analysis, modeling, and visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'fpp3' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'tsibble':
  method               from 
  as_tibble.grouped_df dplyr
── Attaching packages ──────────────────────────────────────────── fpp3 1.0.1 ──
✔ tsibble     1.1.5     ✔ feasts      0.4.1
✔ tsibbledata 0.4.1     ✔ fable       0.4.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tsibble' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'feasts' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'fabletools' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'fable' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ───────────────────────────────────────────────── fpp3_conflicts ──
✖ lubridate::date()    masks base::date()
✖ dplyr::filter()      masks stats::filter()
✖ tsibble::intersect() masks base::intersect()
✖ tsibble::interval()  masks lubridate::interval()
✖ dplyr::lag()         masks stats::lag()
✖ tsibble::setdiff()   masks base::setdiff()
✖ tsibble::union()     masks base::union()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'caret' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following objects are masked from 'package:fabletools':

    MAE, RMSE

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: foreach

Attaching package: 'foreach'

The following objects are masked from 'package:purrr':

    accumulate, when

Loading required package: iterators
Loading required package: parallel</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RWeka)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rpart' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'corrplot' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'openxlsx' was built under R version 4.3.3</code></pre>
</div>
</div>
<p>Since these models take a long time to train, we’ll utilize the <code>doParallel</code> package for speed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    cluster</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load data</h2>
<p>First, we load the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>StudentData <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"StudentData.xlsx"</span>) <span class="co"># Training data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>StudentEvaluation <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"StudentEvaluation.xlsx"</span>) <span class="co"># Test data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<p>We browse the data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>StudentData <span class="sc">|&gt;</span> <span class="fu">skim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">StudentData</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">2571</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Brand Code</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Carb Volume</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.37</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">5.04</td>
<td style="text-align: right;">5.29</td>
<td style="text-align: right;">5.35</td>
<td style="text-align: right;">5.45</td>
<td style="text-align: right;">5.70</td>
<td style="text-align: left;">▁▆▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fill Ounces</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">23.97</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">23.63</td>
<td style="text-align: right;">23.92</td>
<td style="text-align: right;">23.97</td>
<td style="text-align: right;">24.03</td>
<td style="text-align: right;">24.32</td>
<td style="text-align: left;">▁▂▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC Volume</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Pressure</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">68.19</td>
<td style="text-align: right;">3.54</td>
<td style="text-align: right;">57.00</td>
<td style="text-align: right;">65.60</td>
<td style="text-align: right;">68.20</td>
<td style="text-align: right;">70.60</td>
<td style="text-align: right;">79.40</td>
<td style="text-align: left;">▁▅▇▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Carb Temp</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">141.09</td>
<td style="text-align: right;">4.04</td>
<td style="text-align: right;">128.60</td>
<td style="text-align: right;">138.40</td>
<td style="text-align: right;">140.80</td>
<td style="text-align: right;">143.80</td>
<td style="text-align: right;">154.00</td>
<td style="text-align: left;">▁▅▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSC</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: left;">▆▇▃▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSC Fill</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">▆▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSC CO2</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">▇▅▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mnf Flow</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">24.57</td>
<td style="text-align: right;">119.48</td>
<td style="text-align: right;">-100.20</td>
<td style="text-align: right;">-100.00</td>
<td style="text-align: right;">65.20</td>
<td style="text-align: right;">140.80</td>
<td style="text-align: right;">229.40</td>
<td style="text-align: left;">▇▁▁▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Pressure1</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">122.59</td>
<td style="text-align: right;">4.74</td>
<td style="text-align: right;">105.60</td>
<td style="text-align: right;">119.00</td>
<td style="text-align: right;">123.20</td>
<td style="text-align: right;">125.40</td>
<td style="text-align: right;">140.20</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fill Pressure</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">47.92</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">34.60</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">46.40</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">60.40</td>
<td style="text-align: left;">▁▁▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hyd Pressure1</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">12.44</td>
<td style="text-align: right;">12.43</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">11.40</td>
<td style="text-align: right;">20.20</td>
<td style="text-align: right;">58.00</td>
<td style="text-align: left;">▇▅▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hyd Pressure2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">20.96</td>
<td style="text-align: right;">16.39</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">28.60</td>
<td style="text-align: right;">34.60</td>
<td style="text-align: right;">59.40</td>
<td style="text-align: left;">▇▂▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hyd Pressure3</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">20.46</td>
<td style="text-align: right;">15.98</td>
<td style="text-align: right;">-1.20</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">27.60</td>
<td style="text-align: right;">33.40</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: left;">▇▁▃▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hyd Pressure4</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">96.29</td>
<td style="text-align: right;">13.12</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: right;">86.00</td>
<td style="text-align: right;">96.00</td>
<td style="text-align: right;">102.00</td>
<td style="text-align: right;">142.00</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Filler Level</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">109.25</td>
<td style="text-align: right;">15.70</td>
<td style="text-align: right;">55.80</td>
<td style="text-align: right;">98.30</td>
<td style="text-align: right;">118.40</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">161.20</td>
<td style="text-align: left;">▁▃▅▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Filler Speed</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">3687.20</td>
<td style="text-align: right;">770.82</td>
<td style="text-align: right;">998.00</td>
<td style="text-align: right;">3888.00</td>
<td style="text-align: right;">3982.00</td>
<td style="text-align: right;">3998.00</td>
<td style="text-align: right;">4030.00</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">65.97</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">63.60</td>
<td style="text-align: right;">65.20</td>
<td style="text-align: right;">65.60</td>
<td style="text-align: right;">66.40</td>
<td style="text-align: right;">76.20</td>
<td style="text-align: left;">▇▃▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Usage cont</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">20.99</td>
<td style="text-align: right;">2.98</td>
<td style="text-align: right;">12.08</td>
<td style="text-align: right;">18.36</td>
<td style="text-align: right;">21.79</td>
<td style="text-align: right;">23.75</td>
<td style="text-align: right;">25.90</td>
<td style="text-align: left;">▁▃▅▃▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Flow</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2468.35</td>
<td style="text-align: right;">1073.70</td>
<td style="text-align: right;">26.00</td>
<td style="text-align: right;">1144.00</td>
<td style="text-align: right;">3028.00</td>
<td style="text-align: right;">3186.00</td>
<td style="text-align: right;">5104.00</td>
<td style="text-align: left;">▂▅▆▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Density</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: left;">▁▅▇▂▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">MFR</td>
<td style="text-align: right;">212</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">704.05</td>
<td style="text-align: right;">73.90</td>
<td style="text-align: right;">31.40</td>
<td style="text-align: right;">706.30</td>
<td style="text-align: right;">724.00</td>
<td style="text-align: right;">731.00</td>
<td style="text-align: right;">868.60</td>
<td style="text-align: left;">▁▁▁▂▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Balling</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">3.29</td>
<td style="text-align: right;">4.01</td>
<td style="text-align: left;">▁▇▇▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pressure Vacuum</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-5.22</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">-6.60</td>
<td style="text-align: right;">-5.60</td>
<td style="text-align: right;">-5.40</td>
<td style="text-align: right;">-5.00</td>
<td style="text-align: right;">-3.60</td>
<td style="text-align: left;">▂▇▆▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PH</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">8.55</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">7.88</td>
<td style="text-align: right;">8.44</td>
<td style="text-align: right;">8.54</td>
<td style="text-align: right;">8.68</td>
<td style="text-align: right;">9.36</td>
<td style="text-align: left;">▁▅▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oxygen Filler</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bowl Setpoint</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">109.33</td>
<td style="text-align: right;">15.30</td>
<td style="text-align: right;">70.00</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">140.00</td>
<td style="text-align: left;">▁▂▃▇▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pressure Setpoint</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">47.62</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">44.00</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: left;">▁▇▁▆▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Air Pressurer</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">142.83</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">140.80</td>
<td style="text-align: right;">142.20</td>
<td style="text-align: right;">142.60</td>
<td style="text-align: right;">143.00</td>
<td style="text-align: right;">148.20</td>
<td style="text-align: left;">▅▇▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alch Rel</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">6.90</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">5.28</td>
<td style="text-align: right;">6.54</td>
<td style="text-align: right;">6.56</td>
<td style="text-align: right;">7.24</td>
<td style="text-align: right;">8.62</td>
<td style="text-align: left;">▁▇▂▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Carb Rel</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.44</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">4.96</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">5.40</td>
<td style="text-align: right;">5.54</td>
<td style="text-align: right;">6.06</td>
<td style="text-align: left;">▁▇▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Balling Lvl</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: right;">3.66</td>
<td style="text-align: left;">▁▇▂▁▆</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>StudentEvaluation <span class="sc">|&gt;</span> <span class="fu">skim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">StudentEvaluation</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Brand Code</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PH</td>
<td style="text-align: right;">267</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: left;">:</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Carb Volume</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.37</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">5.15</td>
<td style="text-align: right;">5.29</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">5.47</td>
<td style="text-align: right;">5.67</td>
<td style="text-align: left;">▂▇▃▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fill Ounces</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">23.97</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">23.75</td>
<td style="text-align: right;">23.92</td>
<td style="text-align: right;">23.97</td>
<td style="text-align: right;">24.01</td>
<td style="text-align: right;">24.20</td>
<td style="text-align: left;">▁▅▇▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC Volume</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: left;">▁▆▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Pressure</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">68.25</td>
<td style="text-align: right;">3.86</td>
<td style="text-align: right;">60.20</td>
<td style="text-align: right;">65.30</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">70.60</td>
<td style="text-align: right;">77.60</td>
<td style="text-align: left;">▃▆▇▃▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Carb Temp</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">141.23</td>
<td style="text-align: right;">4.30</td>
<td style="text-align: right;">130.00</td>
<td style="text-align: right;">138.40</td>
<td style="text-align: right;">140.80</td>
<td style="text-align: right;">143.80</td>
<td style="text-align: right;">154.00</td>
<td style="text-align: left;">▁▆▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSC</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">▆▇▃▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSC Fill</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">▇▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSC CO2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">▇▃▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mnf Flow</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">117.76</td>
<td style="text-align: right;">-100.20</td>
<td style="text-align: right;">-100.00</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">141.30</td>
<td style="text-align: right;">220.40</td>
<td style="text-align: left;">▇▁▁▆▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Pressure1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">123.04</td>
<td style="text-align: right;">4.42</td>
<td style="text-align: right;">113.00</td>
<td style="text-align: right;">120.20</td>
<td style="text-align: right;">123.40</td>
<td style="text-align: right;">125.50</td>
<td style="text-align: right;">136.00</td>
<td style="text-align: left;">▃▃▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fill Pressure</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">48.14</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">37.80</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">47.80</td>
<td style="text-align: right;">50.20</td>
<td style="text-align: right;">60.20</td>
<td style="text-align: left;">▁▇▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hyd Pressure1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">12.01</td>
<td style="text-align: right;">13.53</td>
<td style="text-align: right;">-50.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">10.40</td>
<td style="text-align: right;">20.40</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: left;">▁▁▇▆▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hyd Pressure2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">20.11</td>
<td style="text-align: right;">17.21</td>
<td style="text-align: right;">-50.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">26.80</td>
<td style="text-align: right;">34.80</td>
<td style="text-align: right;">61.40</td>
<td style="text-align: left;">▁▁▆▇▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hyd Pressure3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">19.61</td>
<td style="text-align: right;">16.56</td>
<td style="text-align: right;">-50.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">27.70</td>
<td style="text-align: right;">33.00</td>
<td style="text-align: right;">49.20</td>
<td style="text-align: left;">▁▁▆▃▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hyd Pressure4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">97.84</td>
<td style="text-align: right;">13.92</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">90.00</td>
<td style="text-align: right;">98.00</td>
<td style="text-align: right;">104.00</td>
<td style="text-align: right;">140.00</td>
<td style="text-align: left;">▅▆▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Filler Level</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">110.29</td>
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">69.20</td>
<td style="text-align: right;">100.60</td>
<td style="text-align: right;">118.60</td>
<td style="text-align: right;">120.20</td>
<td style="text-align: right;">153.20</td>
<td style="text-align: left;">▂▃▇▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Filler Speed</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">3581.39</td>
<td style="text-align: right;">911.19</td>
<td style="text-align: right;">1006.00</td>
<td style="text-align: right;">3812.00</td>
<td style="text-align: right;">3978.00</td>
<td style="text-align: right;">3996.00</td>
<td style="text-align: right;">4020.00</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">66.23</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">63.80</td>
<td style="text-align: right;">65.40</td>
<td style="text-align: right;">65.80</td>
<td style="text-align: right;">66.60</td>
<td style="text-align: right;">75.40</td>
<td style="text-align: left;">▇▅▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Usage cont</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">20.90</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">12.90</td>
<td style="text-align: right;">18.12</td>
<td style="text-align: right;">21.44</td>
<td style="text-align: right;">23.74</td>
<td style="text-align: right;">24.60</td>
<td style="text-align: left;">▁▃▃▃▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Flow</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2408.64</td>
<td style="text-align: right;">1161.36</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1083.00</td>
<td style="text-align: right;">3038.00</td>
<td style="text-align: right;">3215.00</td>
<td style="text-align: right;">3858.00</td>
<td style="text-align: left;">▂▃▁▆▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Density</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: left;">▁▁▇▁▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">MFR</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">697.80</td>
<td style="text-align: right;">96.40</td>
<td style="text-align: right;">15.60</td>
<td style="text-align: right;">707.00</td>
<td style="text-align: right;">724.60</td>
<td style="text-align: right;">731.45</td>
<td style="text-align: right;">784.80</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Balling</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: left;">▅▇▁▂▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pressure Vacuum</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-5.17</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">-6.40</td>
<td style="text-align: right;">-5.60</td>
<td style="text-align: right;">-5.20</td>
<td style="text-align: right;">-4.80</td>
<td style="text-align: right;">-3.60</td>
<td style="text-align: left;">▁▇▆▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oxygen Filler</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bowl Setpoint</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">109.62</td>
<td style="text-align: right;">15.02</td>
<td style="text-align: right;">70.00</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">130.00</td>
<td style="text-align: left;">▁▂▁▃▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pressure Setpoint</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">47.73</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">44.00</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: left;">▁▇▁▆▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Air Pressurer</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">142.83</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">141.20</td>
<td style="text-align: right;">142.20</td>
<td style="text-align: right;">142.60</td>
<td style="text-align: right;">142.80</td>
<td style="text-align: right;">147.20</td>
<td style="text-align: left;">▅▇▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alch Rel</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">6.91</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">6.40</td>
<td style="text-align: right;">6.54</td>
<td style="text-align: right;">6.58</td>
<td style="text-align: right;">7.18</td>
<td style="text-align: right;">7.82</td>
<td style="text-align: left;">▇▁▂▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Rel</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">5.44</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">5.18</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">5.40</td>
<td style="text-align: right;">5.56</td>
<td style="text-align: right;">5.74</td>
<td style="text-align: left;">▂▇▂▃▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Balling Lvl</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.42</td>
<td style="text-align: left;">▁▃▇▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Below, we will perform exploratory data analysis (EDA) to understand the dataset better. We will summarize the data, visualize distributions, and check for missing values. We will also explore relationships between predictors and the response variable (pH).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(StudentData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Brand Code         Carb Volume     Fill Ounces      PC Volume      
 Length:2571        Min.   :5.040   Min.   :23.63   Min.   :0.07933  
 Class :character   1st Qu.:5.293   1st Qu.:23.92   1st Qu.:0.23917  
 Mode  :character   Median :5.347   Median :23.97   Median :0.27133  
                    Mean   :5.370   Mean   :23.97   Mean   :0.27712  
                    3rd Qu.:5.453   3rd Qu.:24.03   3rd Qu.:0.31200  
                    Max.   :5.700   Max.   :24.32   Max.   :0.47800  
                    NA's   :10      NA's   :38      NA's   :39       
 Carb Pressure     Carb Temp          PSC             PSC Fill     
 Min.   :57.00   Min.   :128.6   Min.   :0.00200   Min.   :0.0000  
 1st Qu.:65.60   1st Qu.:138.4   1st Qu.:0.04800   1st Qu.:0.1000  
 Median :68.20   Median :140.8   Median :0.07600   Median :0.1800  
 Mean   :68.19   Mean   :141.1   Mean   :0.08457   Mean   :0.1954  
 3rd Qu.:70.60   3rd Qu.:143.8   3rd Qu.:0.11200   3rd Qu.:0.2600  
 Max.   :79.40   Max.   :154.0   Max.   :0.27000   Max.   :0.6200  
 NA's   :27      NA's   :26      NA's   :33        NA's   :23      
    PSC CO2           Mnf Flow       Carb Pressure1  Fill Pressure  
 Min.   :0.00000   Min.   :-100.20   Min.   :105.6   Min.   :34.60  
 1st Qu.:0.02000   1st Qu.:-100.00   1st Qu.:119.0   1st Qu.:46.00  
 Median :0.04000   Median :  65.20   Median :123.2   Median :46.40  
 Mean   :0.05641   Mean   :  24.57   Mean   :122.6   Mean   :47.92  
 3rd Qu.:0.08000   3rd Qu.: 140.80   3rd Qu.:125.4   3rd Qu.:50.00  
 Max.   :0.24000   Max.   : 229.40   Max.   :140.2   Max.   :60.40  
 NA's   :39        NA's   :2         NA's   :32      NA's   :22     
 Hyd Pressure1   Hyd Pressure2   Hyd Pressure3   Hyd Pressure4   
 Min.   :-0.80   Min.   : 0.00   Min.   :-1.20   Min.   : 52.00  
 1st Qu.: 0.00   1st Qu.: 0.00   1st Qu.: 0.00   1st Qu.: 86.00  
 Median :11.40   Median :28.60   Median :27.60   Median : 96.00  
 Mean   :12.44   Mean   :20.96   Mean   :20.46   Mean   : 96.29  
 3rd Qu.:20.20   3rd Qu.:34.60   3rd Qu.:33.40   3rd Qu.:102.00  
 Max.   :58.00   Max.   :59.40   Max.   :50.00   Max.   :142.00  
 NA's   :11      NA's   :15      NA's   :15      NA's   :30      
  Filler Level    Filler Speed   Temperature      Usage cont      Carb Flow   
 Min.   : 55.8   Min.   : 998   Min.   :63.60   Min.   :12.08   Min.   :  26  
 1st Qu.: 98.3   1st Qu.:3888   1st Qu.:65.20   1st Qu.:18.36   1st Qu.:1144  
 Median :118.4   Median :3982   Median :65.60   Median :21.79   Median :3028  
 Mean   :109.3   Mean   :3687   Mean   :65.97   Mean   :20.99   Mean   :2468  
 3rd Qu.:120.0   3rd Qu.:3998   3rd Qu.:66.40   3rd Qu.:23.75   3rd Qu.:3186  
 Max.   :161.2   Max.   :4030   Max.   :76.20   Max.   :25.90   Max.   :5104  
 NA's   :20      NA's   :57     NA's   :14      NA's   :5       NA's   :2     
    Density           MFR           Balling       Pressure Vacuum 
 Min.   :0.240   Min.   : 31.4   Min.   :-0.170   Min.   :-6.600  
 1st Qu.:0.900   1st Qu.:706.3   1st Qu.: 1.496   1st Qu.:-5.600  
 Median :0.980   Median :724.0   Median : 1.648   Median :-5.400  
 Mean   :1.174   Mean   :704.0   Mean   : 2.198   Mean   :-5.216  
 3rd Qu.:1.620   3rd Qu.:731.0   3rd Qu.: 3.292   3rd Qu.:-5.000  
 Max.   :1.920   Max.   :868.6   Max.   : 4.012   Max.   :-3.600  
 NA's   :1       NA's   :212     NA's   :1                        
       PH        Oxygen Filler     Bowl Setpoint   Pressure Setpoint
 Min.   :7.880   Min.   :0.00240   Min.   : 70.0   Min.   :44.00    
 1st Qu.:8.440   1st Qu.:0.02200   1st Qu.:100.0   1st Qu.:46.00    
 Median :8.540   Median :0.03340   Median :120.0   Median :46.00    
 Mean   :8.546   Mean   :0.04684   Mean   :109.3   Mean   :47.62    
 3rd Qu.:8.680   3rd Qu.:0.06000   3rd Qu.:120.0   3rd Qu.:50.00    
 Max.   :9.360   Max.   :0.40000   Max.   :140.0   Max.   :52.00    
 NA's   :4       NA's   :12        NA's   :2       NA's   :12       
 Air Pressurer      Alch Rel        Carb Rel      Balling Lvl  
 Min.   :140.8   Min.   :5.280   Min.   :4.960   Min.   :0.00  
 1st Qu.:142.2   1st Qu.:6.540   1st Qu.:5.340   1st Qu.:1.38  
 Median :142.6   Median :6.560   Median :5.400   Median :1.48  
 Mean   :142.8   Mean   :6.897   Mean   :5.437   Mean   :2.05  
 3rd Qu.:143.0   3rd Qu.:7.240   3rd Qu.:5.540   3rd Qu.:3.14  
 Max.   :148.2   Max.   :8.620   Max.   :6.060   Max.   :3.66  
                 NA's   :9       NA's   :10      NA's   :1     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograms</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_histogram</span>(StudentData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize missing data</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>StudentData <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.)))) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 2
   name           value
   &lt;chr&gt;          &lt;int&gt;
 1 MFR              212
 2 Brand Code       120
 3 Filler Speed      57
 4 PC Volume         39
 5 PSC CO2           39
 6 Fill Ounces       38
 7 PSC               33
 8 Carb Pressure1    32
 9 Hyd Pressure4     30
10 Carb Pressure     27
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot missing data</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(StudentData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> StudentData <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    correlation_matrix,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="st">"hclust"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># addCoef.col = "grey",</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># addCoefasPercent = TRUE,</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.cex =</span> <span class="fl">0.7</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature plot</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">featurePlot</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> StudentData <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>PH),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> StudentData<span class="sc">$</span>PH,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> <span class="st">"scatter"</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the visualizations and summary statistics above, we can observe:</p>
<ol type="1">
<li>Distribution patterns:
<ul>
<li>Some variables show some skewness, e.g., <code>Filler.Speed</code>, <code>MFR</code>, <code>Oxygen.Filler</code>, and <code>Usage.cont</code></li>
<li>Many variables are bimodal, e.g., <code>Air.Pressurer</code>, <code>Balling</code>, <code>Balling.Lvl</code>, <code>Carb.Flow</code>, <code>Carb.Rel</code>, and <code>Density</code></li>
<li>The target variable <code>PH</code> has a relatively normal distribution</li>
</ul></li>
<li>Correlations:
<ul>
<li>Several predictors show moderate correlations with <code>PH</code>, e.g., <code>Mnf Flow</code>, <code>Usage cont</code>, <code>Filler Level</code>, <code>Bowl Setpoint</code>, and <code>Pressure Setpoint</code></li>
<li>There are some strong correlations between predictors, suggesting potential multicollinearity. We should address multicollinearity in the data cleaning phase</li>
</ul></li>
<li>Missing values:
<ul>
<li>Several variables contain missing values that will need to be addressed, especially <code>MFR</code></li>
</ul></li>
</ol>
</section>
<section id="clean-and-tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="clean-and-tidy-data">Clean and Tidy Data</h2>
<p>Mutate variable types (e.g., convert character column <code>Brand Code</code> to factor, numeric, etc., so we can use this to forecast data).</p>
<p>Browse and remove outliers if necessary.</p>
<p>Impute and transform if necessary.</p>
<ul>
<li><p>Andreina to impute</p></li>
<li><p>Adreina to check correlation, remove features that have correlation over some threshold</p></li>
<li><p>Remove near zero variance predictors with <code>nearZeroVar()</code>.</p></li>
</ul>
</section>
<section id="forecast" class="level2">
<h2 class="anchored" data-anchor-id="forecast">Forecast</h2>
<p>We will try the following models:</p>
<ul>
<li>Linear regression models:
<ul>
<li>PLS</li>
<li>Elastic Net</li>
</ul></li>
<li>Non-linear regression models:
<ul>
<li>KNN</li>
<li>Multivariate Adaptive Regression Splines (MARS)</li>
</ul></li>
<li>Tree-based regression models:
<ul>
<li>Single Tree</li>
<li>Model Tree</li>
</ul></li>
</ul>
<p>Since the data is relatively large, we will avoid heavy models like neural networks, support vector machines (SVM), or boosted trees. Since we have a lot of predictors, we opt for models that handle feature selection or dimensionality reduction like elastic net, PLS, and tree-based models. We also want model results to be easy to interpret for our non-technical report, so we focus on elastic net, MARS, and single/model trees.</p>
<p>Also, because the data is relatively large, we can afford to use a training and a test set. We also center and scale the data to ensure that all predictors are on the same scale, which is important for models like PLS and elastic net.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;!--NB to DELETE this line after imputation section is completed--&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>StudentData <span class="ot">&lt;-</span> StudentData <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into a training and a test set</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>trainingRows <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    StudentData<span class="sc">$</span>PH,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> .<span class="dv">80</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">list =</span> <span class="cn">FALSE</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>StudentData_train <span class="ot">&lt;-</span> StudentData[trainingRows, ]</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>StudentData_test <span class="ot">&lt;-</span> StudentData[<span class="sc">-</span>trainingRows, ]</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Save training and test predictors and response variables</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>StudentData_train_x <span class="ot">&lt;-</span> StudentData_train[, <span class="sc">!</span><span class="fu">names</span>(StudentData_train) <span class="sc">%in%</span> <span class="st">"PH"</span>]</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>StudentData_train_y <span class="ot">&lt;-</span> StudentData_train<span class="sc">$</span>PH</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>StudentData_test_x <span class="ot">&lt;-</span> StudentData_test[, <span class="sc">!</span><span class="fu">names</span>(StudentData_test) <span class="sc">%in%</span> <span class="st">"PH"</span>]</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>StudentData_test_y <span class="ot">&lt;-</span> StudentData_test<span class="sc">$</span>PH</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fitting models to the training data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-process the data and tune a PLS model</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>plsTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pls"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">20</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> ctrl,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">preProc =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Setting row names on a tibble is deprecated.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plsTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Partial Least Squares 

1631 samples
  32 predictor

Pre-processing: centered (31), scaled (31), ignore (1) 
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1467, 1469, 1469, 1467, 1468, 1468, ... 
Resampling results across tuning parameters:

  ncomp  RMSE       Rsquared   MAE       
   1     0.1488582  0.2312502  0.11802022
   2     0.1403490  0.3151460  0.10925305
   3     0.1372490  0.3440205  0.10791799
   4     0.1344702  0.3705490  0.10379107
   5     0.1318583  0.3942403  0.10276366
   6     0.1305447  0.4066477  0.10198990
   7     0.1299001  0.4123502  0.10135662
   8     0.1297131  0.4143680  0.10131623
   9     0.1293449  0.4178913  0.10088115
  10     0.1293386  0.4180088  0.10075248
  11     0.1290863  0.4205050  0.10054825
  12     0.1290656  0.4208149  0.10049633
  13     0.1290394  0.4210244  0.10044179
  14     0.1289513  0.4218954  0.10024119
  15     0.1287685  0.4236308  0.09993350
  16     0.1285894  0.4253852  0.09982035
  17     0.1285303  0.4258924  0.09961838
  18     0.1284027  0.4271440  0.09970902
  19     0.1283007  0.4282049  0.09965762
  20     0.1281120  0.4299008  0.09955418

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was ncomp = 20.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>plsPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    plsTune,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;!--NB to DELETE this line after data cleaning section is completed and variable types are changed to numeric--&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>StudentData_train_x <span class="ot">&lt;-</span> StudentData_train_x[, <span class="fu">sapply</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    is.numeric</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>enetGrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.lambda =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>, .<span class="dv">1</span>),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fraction =</span> <span class="fu">seq</span>(.<span class="dv">05</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>enetTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"enet"</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneGrid =</span> enetGrid,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> ctrl,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">preProc =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>enetTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Elasticnet 

1631 samples
  31 predictor

Pre-processing: centered (31), scaled (31) 
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1468, 1467, 1468, 1469, 1467, 1468, ... 
Resampling results across tuning parameters:

  lambda  fraction  RMSE       Rsquared   MAE      
  0.00    0.05      0.1544718  0.2149958  0.1230890
  0.00    0.10      0.1467786  0.2771951  0.1162944
  0.00    0.15      0.1426109  0.3031205  0.1124957
  0.00    0.20      0.1405586  0.3188817  0.1104148
  0.00    0.25      0.1390096  0.3325521  0.1086515
  0.00    0.30      0.1377715  0.3436377  0.1072205
  0.00    0.35      0.1369665  0.3503563  0.1060774
  0.00    0.40      0.1364387  0.3548427  0.1052549
  0.00    0.45      0.1361471  0.3573542  0.1048917
  0.00    0.50      0.1359297  0.3593457  0.1046464
  0.00    0.55      0.1358343  0.3601857  0.1045007
  0.00    0.60      0.1358063  0.3606743  0.1044229
  0.00    0.65      0.1357704  0.3610418  0.1043340
  0.00    0.70      0.1357506  0.3612453  0.1042665
  0.00    0.75      0.1357407  0.3613728  0.1041949
  0.00    0.80      0.1357318  0.3614907  0.1041135
  0.00    0.85      0.1357324  0.3615253  0.1040391
  0.00    0.90      0.1357428  0.3614858  0.1039702
  0.00    0.95      0.1357528  0.3614637  0.1038979
  0.00    1.00      0.1357729  0.3613638  0.1038332
  0.01    0.05      0.1582099  0.2084336  0.1266428
  0.01    0.10      0.1516715  0.2431841  0.1206247
  0.01    0.15      0.1469865  0.2759747  0.1164877
  0.01    0.20      0.1438545  0.2937315  0.1136494
  0.01    0.25      0.1418432  0.3083822  0.1117560
  0.01    0.30      0.1406711  0.3175804  0.1105375
  0.01    0.35      0.1396099  0.3268703  0.1093613
  0.01    0.40      0.1387222  0.3348994  0.1083281
  0.01    0.45      0.1379139  0.3421496  0.1073939
  0.01    0.50      0.1373056  0.3473244  0.1065829
  0.01    0.55      0.1368665  0.3510157  0.1059122
  0.01    0.60      0.1365376  0.3538737  0.1054231
  0.01    0.65      0.1362926  0.3560433  0.1051370
  0.01    0.70      0.1361252  0.3575358  0.1049420
  0.01    0.75      0.1359769  0.3588815  0.1047614
  0.01    0.80      0.1358924  0.3596635  0.1046280
  0.01    0.85      0.1359101  0.3596421  0.1046001
  0.01    0.90      0.1359050  0.3597513  0.1045436
  0.01    0.95      0.1358924  0.3598888  0.1044772
  0.01    1.00      0.1358679  0.3601379  0.1044057
  0.10    0.05      0.1612019  0.2084336  0.1293915
  0.10    0.10      0.1554110  0.2122004  0.1240415
  0.10    0.15      0.1514432  0.2455529  0.1204324
  0.10    0.20      0.1480993  0.2681763  0.1175007
  0.10    0.25      0.1454911  0.2831429  0.1151731
  0.10    0.30      0.1436141  0.2932520  0.1134676
  0.10    0.35      0.1423316  0.3020636  0.1122562
  0.10    0.40      0.1412856  0.3102979  0.1112060
  0.10    0.45      0.1406064  0.3155423  0.1105166
  0.10    0.50      0.1400591  0.3203704  0.1098880
  0.10    0.55      0.1394972  0.3255799  0.1092119
  0.10    0.60      0.1389132  0.3311006  0.1085306
  0.10    0.65      0.1384089  0.3358214  0.1079114
  0.10    0.70      0.1380362  0.3392911  0.1074006
  0.10    0.75      0.1377200  0.3422602  0.1069867
  0.10    0.80      0.1374268  0.3450740  0.1066320
  0.10    0.85      0.1371968  0.3473662  0.1063640
  0.10    0.90      0.1370358  0.3490309  0.1061782
  0.10    0.95      0.1369242  0.3502551  0.1060505
  0.10    1.00      0.1368599  0.3510408  0.1059540

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were fraction = 0.8 and lambda = 0.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>enetPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    enetTune,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>knnTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">preProc =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>knnTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k-Nearest Neighbors 

1631 samples
  31 predictor

Pre-processing: centered (31), scaled (31) 
Resampling: Bootstrapped (25 reps) 
Summary of sample sizes: 1631, 1631, 1631, 1631, 1631, 1631, ... 
Resampling results across tuning parameters:

  k   RMSE       Rsquared   MAE       
   5  0.1315518  0.4277552  0.09476926
   7  0.1289443  0.4416956  0.09411419
   9  0.1283847  0.4443694  0.09457960
  11  0.1284035  0.4432301  0.09536790
  13  0.1285859  0.4418627  0.09596556
  15  0.1289453  0.4387390  0.09660949
  17  0.1295149  0.4339626  0.09738143
  19  0.1299825  0.4298868  0.09796850
  21  0.1304398  0.4259026  0.09850425
  23  0.1309664  0.4215519  0.09907507

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was k = 9.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>knnPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    knnTune,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>marsGrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">.degree =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">.nprune =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">38</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>marsTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"earth"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneGrid =</span> marsGrid,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>marsTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Multivariate Adaptive Regression Spline 

1631 samples
  31 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1469, 1468, 1468, 1466, 1468, 1469, ... 
Resampling results across tuning parameters:

  degree  nprune  RMSE       Rsquared   MAE       
  1        2      0.1505831  0.2124341  0.11812909
  1        3      0.1451888  0.2671346  0.11303827
  1        4      0.1431307  0.2882945  0.11109050
  1        5      0.1406937  0.3124470  0.10845146
  1        6      0.1397143  0.3222664  0.10816894
  1        7      0.1372789  0.3454473  0.10545957
  1        8      0.1363527  0.3544559  0.10443042
  1        9      0.1341219  0.3756600  0.10308559
  1       10      0.1328930  0.3867033  0.10154559
  1       11      0.1326317  0.3895838  0.10099199
  1       12      0.1317351  0.3981864  0.10012161
  1       13      0.1311509  0.4027899  0.09969397
  1       14      0.1309236  0.4045668  0.09925579
  1       15      0.1306100  0.4075744  0.09909086
  1       16      0.1309242  0.4050150  0.09936077
  1       17      0.1308700  0.4055536  0.09931071
  1       18      0.1308700  0.4055536  0.09931071
  1       19      0.1308700  0.4055536  0.09931071
  1       20      0.1308700  0.4055536  0.09931071
  1       21      0.1308700  0.4055536  0.09931071
  1       22      0.1308700  0.4055536  0.09931071
  1       23      0.1308700  0.4055536  0.09931071
  1       24      0.1308700  0.4055536  0.09931071
  1       25      0.1308700  0.4055536  0.09931071
  1       26      0.1308700  0.4055536  0.09931071
  1       27      0.1308700  0.4055536  0.09931071
  1       28      0.1308700  0.4055536  0.09931071
  1       29      0.1308700  0.4055536  0.09931071
  1       30      0.1308700  0.4055536  0.09931071
  1       31      0.1308700  0.4055536  0.09931071
  1       32      0.1308700  0.4055536  0.09931071
  1       33      0.1308700  0.4055536  0.09931071
  1       34      0.1308700  0.4055536  0.09931071
  1       35      0.1308700  0.4055536  0.09931071
  1       36      0.1308700  0.4055536  0.09931071
  1       37      0.1308700  0.4055536  0.09931071
  1       38      0.1308700  0.4055536  0.09931071
  2        2      0.1510153  0.2084855  0.11834944
  2        3      0.1457172  0.2622034  0.11392528
  2        4      0.1444882  0.2760331  0.11321395
  2        5      0.1414100  0.3067198  0.11090676
  2        6      0.1388194  0.3329044  0.10778494
  2        7      0.1369994  0.3501242  0.10707378
  2        8      0.1365666  0.3561414  0.10567846
  2        9      0.1350473  0.3714135  0.10401819
  2       10      0.1344267  0.3779620  0.10316075
  2       11      0.1332649  0.3898977  0.10211423
  2       12      0.1328509  0.3938549  0.10139202
  2       13      0.1313871  0.4065265  0.10001403
  2       14      0.1312322  0.4074075  0.09939130
  2       15      0.1304508  0.4145951  0.09878813
  2       16      0.1285197  0.4311877  0.09709314
  2       17      0.1282537  0.4334584  0.09686607
  2       18      0.1286203  0.4301715  0.09699553
  2       19      0.1276414  0.4387697  0.09603240
  2       20      0.1272201  0.4431345  0.09552174
  2       21      0.1270819  0.4444447  0.09537120
  2       22      0.1268358  0.4468873  0.09516126
  2       23      0.1258427  0.4541267  0.09428635
  2       24      0.1255654  0.4567109  0.09409436
  2       25      0.1248789  0.4622482  0.09380796
  2       26      0.1247663  0.4631102  0.09367055
  2       27      0.1244957  0.4650960  0.09337548
  2       28      0.1246991  0.4638499  0.09352344
  2       29      0.1247830  0.4637316  0.09370072
  2       30      0.1245745  0.4653638  0.09353993
  2       31      0.1246118  0.4650547  0.09358441
  2       32      0.1245431  0.4655708  0.09352139
  2       33      0.1246083  0.4651024  0.09348239
  2       34      0.1246083  0.4651024  0.09348239
  2       35      0.1246083  0.4651024  0.09348239
  2       36      0.1246083  0.4651024  0.09348239
  2       37      0.1246083  0.4651024  0.09348239
  2       38      0.1246083  0.4651024  0.09348239

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were nprune = 27 and degree = 2.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>marsPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    marsTune,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>rpartTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"rpart2"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>rpartTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

1631 samples
  31 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1468, 1467, 1468, 1469, 1467, 1467, ... 
Resampling results across tuning parameters:

  maxdepth  RMSE       Rsquared   MAE      
   1        0.1531161  0.1871227  0.1207223
   2        0.1488734  0.2308669  0.1168855
   3        0.1434159  0.2863317  0.1125699
   4        0.1411887  0.3091626  0.1106931
   5        0.1399220  0.3221780  0.1092792
   6        0.1375519  0.3451473  0.1079436
  10        0.1355002  0.3656720  0.1055541
  11        0.1353360  0.3682291  0.1051929
  12        0.1355501  0.3663716  0.1049364
  13        0.1361143  0.3632859  0.1049431

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was maxdepth = 11.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>rpartPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    rpartTune,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>m5Tune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"M5"</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">Weka_control</span>(<span class="at">M =</span> <span class="dv">10</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>m5Tune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model Tree 

1631 samples
  31 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1469, 1469, 1468, 1468, 1468, 1469, ... 
Resampling results across tuning parameters:

  pruned  smoothed  rules  RMSE       Rsquared    MAE       
  Yes     Yes       Yes    1.1366185  0.25025375  0.66145002
  Yes     Yes       No     0.4008688  0.39706345  0.34988728
  Yes     No        Yes    0.1450165  0.39605847  0.09718701
  Yes     No        No     0.1705464  0.37269597  0.09931158
  No      Yes       Yes    1.3770318  0.01689254  0.59629505
  No      Yes       No     0.3868197  0.43345928  0.34594068
  No      No        Yes    0.1433173  0.36614315  0.10325043
  No      No        No     0.1379532  0.42095454  0.09498528

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were pruned = No, smoothed = No and rules
 = No.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>m5Pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    m5Tune,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compare-model-fit-and-select-optimal-model" class="level2">
<h2 class="anchored" data-anchor-id="compare-model-fit-and-select-optimal-model">Compare model fit and select optimal model</h2>
<p>Next, we compare fit and pick model to export.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ranking <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="fu">c</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PLS"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Elastic Net"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"KNN"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MARS"</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Single Tree"</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Model Tree"</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> plsPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> enetPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> knnPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> marsPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> rpartPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> m5Pred, <span class="at">obs =</span> StudentData_test_y)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(RMSE)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>ranking</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Model      RMSE  Rsquared        MAE
1         KNN 0.1218347 0.5227203 0.09077150
2        MARS 0.1268342 0.4816102 0.09488807
3  Model Tree 0.1304262 0.4911121 0.08767047
4         PLS 0.1345812 0.4156022 0.10310097
5 Elastic Net 0.1387124 0.3797177 0.10456975
6 Single Tree 0.1401199 0.3691956 0.10504268</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>best <span class="ot">&lt;-</span> ranking[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>The KNN model gives the optimal resampling and test set performance since it has the lowest RMSE and highest R squared.</strong></p>
</section>
<section id="predict-ph-for-test-set" class="level2">
<h2 class="anchored" data-anchor-id="predict-ph-for-test-set">Predict pH for test set</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict pH for the test set using the best model</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"PLS"</span>) {</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> plsTune</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"Elastic Net"</span>) {</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> enetTune</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"KNN"</span>) {</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> knnTune</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"MARS"</span>) {</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> marsTune</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"Single Tree"</span>) {</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> rpartTune</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"Model Tree"</span>) {</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> m5Tune</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>StudentEvaluation_x <span class="ot">&lt;-</span> StudentEvaluation <span class="sc">|&gt;</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>PH) <span class="sc">|&gt;</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="co"># &lt;!--NB to DELETE this line after imputation section is completed--&gt;</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine predictions with the test set</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    StudentEvaluation_x,</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">PH =</span> <span class="fu">predict</span>(finalTune, <span class="at">newdata =</span> StudentEvaluation_x)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="export" class="level2">
<h2 class="anchored" data-anchor-id="export">Export</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export predictions to Excel</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(predictions, <span class="st">"PH_forecasts.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>[RP?]</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>